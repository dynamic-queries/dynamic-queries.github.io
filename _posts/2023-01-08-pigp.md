---
layout: post
title: Physics informed Gaussian processes.
date: 2023-08-01 00:00:00-0000
description: Structure aware identification of dynamical systems with GPs.
tags: SDEs
categories: projects
related_posts: false
urlcolor: "blue"
---

*This is preliminary research conducted during my Masters studies (2020-2022) at TUM with [Ravi Kislaya](https://www.cs.cit.tum.de/en/sccs/people/kislaya-ravi/)*.

### Introduction

Building on the previous post of inferring dynamical systems with [multi-output GPs](https://dynamic-queries.github.io/blog/2023/mogp/), we formulate learning a statistical model from data based on the structure of the mechanistic models underlying that dynamical system. To wit:

Consider the dynamical system.
$$
\begin{align}
    \frac{dx(t)}{dt} = f(x(t)) \\ 
    x(0) = x_0 \in \mathbb{R}^d
\end{align}
$$

If one has observables of this dynamical systems obtained at discrete time points such as $$X := [\hat{x}(t_1),\hat{x}(t_2),...,\hat{x}(t_N)]$$ and the forcing function $$f(x)$$, we would like to infer a statistical model (in this case, a GP) that aids as a reliable predictor for $$x(t)$$. Here, GP is used as a surrogate and does not exactly fit the label of systems identification. 

### Method

This can be realized as follows. Let

$$
x(t) \sim \mathcal{GP}(\mu(t), \kappa(t,t'))
$$

Let $$\kappa$$ be a sufficiently smooth covariance kernel. Then,

$$
    \partial_t \: x(t) \sim \mathcal{GP}(\partial_t \mu(t), \partial_t \partial_{t'} \: \kappa(t,t'))
$$

From this, the log-likelihood can be written as

$$
    log \: p(x|\theta) := \sum_{i=1}^N \: \| \partial_t \: x(t_i) - f(x(t_i))\|_2 + \|\hat{x}(t_i) - x_i(t_i) \|_2
$$

And as always one, chooses a zero mean Gaussian prior for a GP. 

$$
    p(\theta) := \mathcal{N}(0,\kappa(t,t'))
$$

There are a couple of approaches to this inference procedure. One could write down an expression for the posterior and perform MAP. Otherwise, one can do variational inference. We demonstrate both these procedures in the following example.

### Examples

##### Logistic equation

##### Lotka-Voltera model

##### Duffling oscillator

##### Robertson's reaction system

### Relationship with probabilistic ODE solvers

Probabilistic ODE solvers use the same method, but for the purpose of solving ODEs. However, when GPs are used as surrogates for finely discretized solutions to partial differential equations, incorporating the derivative information into the likelihood should result in improved inference, requiring fewer input reference datapoints. While the difference is subtle, it did not seem appropriate to further investigate this, considering that a large body of work had already been carried out on improving probabilistic integrators.

### Code